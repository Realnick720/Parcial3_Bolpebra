{"version":3,"sources":["libro.js"],"names":["_datosLibros","resultado","e","elemento","$","modal","eliminarExitoso","currentTarget","closest","remove","success","titulo","toastr","Mensaje","datos","id","solicitudAjax","response","tipo","confirmarEliminar","tipoDatos","html","url","css","min-height","backdrop","keyboard","unbind","click","guardarLibroExitoso","respuesta","Success","val","autor","isbn","idioma","fechapublicacion","cantpaginas","libro","Data","push","parseInt","mostrarDatosLibros","limpiarDatos","hide","show","find","width","editarDatos","mostrarModalLibro","eventoActualizarLibro","input","event","preventDefault","formatDate","date","year","getFullYear","month","slice","day","getDate","concat","each","index","attr","col","crearSpan","fila","append","mostrarEliminarLibro","guardarLibro","getLibrosExitoso","dateString","error","limpiarTabla"],"mappings":"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","file":"libro.min.js","sourcesContent":["var _datosLibros;\r\n\r\nfunction eliminarExitoso(resultado, e, elemento) {\r\n    $(\"#eliminarLibro\").modal(\"hide\");\r\n    if (resultado.Success) {\r\n        $(e.currentTarget).closest('tr').remove();\r\n        _datosLibros.remove(elemento);\r\n        toastr.success(\"El Libro'\" + elemento.titulo + \r\n            \" '   se ha eliminado satisfactoriamente\");\r\n    } else {\r\n        toastr.error(resultado.Mensaje);\r\n    }\r\n}\r\n\r\nfunction confirmarEliminar(e, elemento) {\r\n    var url = \"/EliminarLibro\";\r\n    var tipo = 'POST';\r\n    var datos = { id: elemento.id };\r\n    var tipoDatos = 'JSON';\r\n    solicitudAjax(url, function (response) { eliminarExitoso(response, e, elemento); }\r\n    , datos, tipoDatos, tipo);\r\n}\r\nfunction mostrarEliminarLibro(e, elemento) {\r\n    var modal = '#eliminarLibro';\r\n    $(modal).find(\".modal-title\").html('Eliminar Libro');\r\n    $(modal).find(\".text-mensaje-modal\").html('Esta seguro que desea eliminar el Libro '\r\n        + \"'\" + elemento.titulo + \"'    ?\");\r\n    $(modal).find(\".modal-body\").css({ 'min-height': 100 + \"px\" });    \r\n    $(modal).modal({ backdrop: 'static', keyboard: false });\r\n    $(modal).modal(\"show\");\r\n    $(\"#btnConfirmarEliminar\").unbind('click').click(function () {\r\n        confirmarEliminar(e, elemento);\r\n    });    \r\n}\r\n\r\nfunction guardarLibroExitoso(respuesta, elemento) {\r\n    if (respuesta.Success) {\r\n        $(\"#agregarLibro\").modal(\"hide\");\r\n        if (elemento) {\r\n            elemento.titulo = $(\"#txtTitulo\").val();\r\n            elemento.autor = $(\"#txtAutor\").val();\r\n            elemento.isbn = $(\"#txtIsbn\").val();\r\n            elemento.idioma = $(\"#txtIdioma\").val();\r\n            elemento.fechapublicacion = $(\"#txtFechaPublicacion\").val();\r\n            elemento.cantpaginas = $(\"#txtCantPaginas\").val();\r\n        } else {\r\n            var libro = {\r\n                id: parseInt(respuesta.Data),\r\n                titulo: $(\"#txtTitulo\").val(),\r\n                autor: $(\"#txtAutor\").val(),\r\n                isbn: $(\"#txtIsbn\").val(),\r\n                idioma: $(\"#txtIdioma\").val(),\r\n                fechapublicacion: $(\"#txtFechaPublicacion\").val(),\r\n                cantpaginas: $(\"#txtCantPaginas\").val(),\r\n            };\r\n            _datosLibros.push(libro);\r\n        }            \r\n        mostrarDatosLibros();\r\n        toastr.success(\"El Libro se ha guardado satisfactoriamente \");\r\n    } else {\r\n        toastr.error(respuesta.Mensaje);\r\n    }    \r\n}\r\n\r\nfunction guardarLibro(id, elemento) {\r\n    var url = \"/GuardarLibro\";\r\n    var tipo = 'POST';\r\n    var datos = {\r\n        id: id,\r\n        titulo: $(\"#txtTitulo\").val(),\r\n        autor: $(\"#txtAutor\").val(),\r\n        isbn: $(\"#txtIsbn\").val(),\r\n        idioma: $(\"#txtIdioma\").val(),\r\n        fechapublicacion: $(\"#txtFechaPublicacion\").val(),\r\n        cantpaginas: $(\"#txtCantPaginas\").val(),\r\n    };\r\n    var tipoDatos = 'JSON';\r\n    solicitudAjax(url, function (response) { guardarLibroExitoso(response, elemento); }\r\n        , datos, tipoDatos, tipo);\r\n}\r\nfunction limpiarDatos() {\r\n    $(\"#txtTitulo\").val(\"\");\r\n    $(\"#txtAutor\").val(\"\");\r\n    $(\"#txtIsbn\").val(\"\");\r\n    $(\"#txtIdioma\").val(\"\");\r\n    $(\"#txtFechaPublicacion\").val(\"\");\r\n    $(\"#txtCantPaginas\").val(\"\");\r\n    $(\"#btnEditar\").hide();\r\n    $(\"#btnGuardar\").show();\r\n}\r\n\r\nfunction mostrarModalLibro() {\r\n    limpiarDatos();\r\n    var modal = '#agregarLibro';    \r\n    $(modal).find(\".modal-title\").html(\"Adicionar Libro\");\r\n    $(modal).find(\".modal-dialog\").css({ \"width\": 700 + \"px\" });\r\n    $(modal).find(\".modal-body\").css({ 'min-height': 150 + \"px\" });\r\n    $(modal).modal({ backdrop: 'static', keyboard: false });\r\n    $(modal).modal(\"show\");\r\n}\r\nfunction editarDatos(elemento) {\r\n    $(\"#txtTitulo\").val(elemento.titulo);\r\n    $(\"#txtAutor\").val(elemento.autor);\r\n    $(\"#txtIsbn\").val(elemento.isbn);\r\n    $(\"#txtIdioma\").val(elemento.idioma);\r\n    $(\"#txtFechaPublicacion\").val(elemento.fechapublicacion);\r\n    $(\"#txtCantPaginas\").val(elemento.cantpaginas);\r\n    $(\"#btnEditar\").show();\r\n    $(\"#btnGuardar\").hide();\r\n}\r\n\r\nfunction eventoActualizarLibro(input, elemento) {\r\n    $(input).unbind('click').click(function () {\r\n        var modal = '#agregarLibro';\r\n        editarDatos(elemento);\r\n        $(modal).find(\".modal-title\").html('Editar Libro : ' + \"'\" + \r\n            elemento.titulo + \"'\");\r\n        $(modal).find(\".modal-dialog\").css({ 'width': 700 + \"px\" });\r\n        $(modal).modal({ backdrop: 'static', keyboard: false });\r\n        $(modal).modal(\"show\");\r\n        $(\"#btnEditar\").unbind('click').click(function (event) {\r\n            event.preventDefault();\r\n            guardarLibro(elemento.id, elemento);\r\n        });\r\n    });\r\n}\r\n\r\n\r\nfunction formatDate(dateString) {\r\n    const date  = new Date(dateString);\r\n    const year  = date.getFullYear();\r\n    const month = ('0' + (date.getMonth() + 1)).slice(-2);\r\n    const day   = ('0' + date.getDate()).slice(-2);\r\n    return `${day}/${month}/${year}`;\r\n}\r\n\r\nfunction mostrarDatosLibros() {\r\n    limpiarTabla('tblLibro');\r\n    $.each(_datosLibros, function (index, elemento) {\r\n        var fila = $('<tr>').attr('id', elemento.id);\r\n        fila.append(col(elemento.id).addClass(\"alinearCentro\"));\r\n        //fila.append(col(elemento.nombre));\r\n        var input = crearSpan(\"lblEdit\" + index, \"spanHyperLink\", elemento.titulo);\r\n        eventoActualizarLibro(input, elemento);\r\n        fila.append(col(input));\r\n        fila.append(col(elemento.autor ));\r\n        fila.append(col(elemento.isbn ));\r\n        fila.append(col(elemento.idioma ));\r\n        fila.append(col(formatDate(elemento.fechapublicacion)));\r\n        fila.append(col(elemento.cantpaginas ));\r\n        fila.append(col(AccionColumna(function (e) { mostrarEliminarLibro(e, elemento) }\r\n            , 'trash', 'Eliminar')).addClass(\"alinearCentro\"));\r\n        $('#tblLibro tbody').append(fila);\r\n    });\r\n}\r\nfunction getLibrosExitoso(resultado) {\r\n    if (resultado.Success) {\r\n        toastr.success(\"Cargado Exitoso\");\r\n        _datosLibros = resultado.Data;\r\n        mostrarDatosLibros();        \r\n    } else {\r\n        toastr.error(resultado.Mensaje);\r\n    }\r\n}\r\n\r\nfunction init() {\r\n    var url = \"/obtenerLibros\";\r\n    var tipo = 'GET';\r\n    var datos = {};\r\n    var tipoDatos = 'JSON';\r\n    solicitudAjax(url, getLibrosExitoso, datos, tipoDatos, tipo);\r\n}\r\n$(document).ready(function () {\r\n    init();  \r\n    $('#btnAdicionar').click(function () { mostrarModalLibro(); });  \r\n    $('#btnCancelar').click(function () { $('#agregarLibro').modal(\"hide\"); });  \r\n    $(\"#btnGuardar\").click(function () { guardarLibro(0); });\r\n    $('#btnCancelarEliminar').click(function () { $(\"#eliminarLibro\").modal(\"hide\"); });    \r\n});"]}